<!DOCTYPE html>
<html>
<head>
  <title>User Dashboard</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background: #e4ffe6; }
    .header {
      background: #bbecfc;
      text-align: center;
      padding: 20px 0 12px 0;
      font-size: 36px;
      color: #208068;
      font-weight: bold;
      letter-spacing:2px;
    }
    .sidebar {
      float: left;
      width: 17%;
      background: #c0f5d9;
      height: 100vh;
      padding: 18px 0 0 20px;
      box-sizing: border-box;
    }
    .sidebar a {
      display: block;
      margin-bottom: 18px;
      color: #222;
      text-decoration: none;
      font-size: 18px;
      font-weight: 500;
    }
    .main {
      margin-left: 17%;
      padding: 34px;
      min-height: 90vh;
    }
    .dashboard-title {
      font-size: 30px;
      letter-spacing:1px;
      color: #145042;
      font-weight: 600;
      margin-bottom: 30px;
    }
    .profile-row {
      display: flex;
      align-items: center;
      gap: 40px;
      margin-bottom: 30px;
    }
    .profile-pic-area {
      position: relative;
      width: 120px;
      height: 120px;
    }
    .profile-pic {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: #bbecfc;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: #227c6d;
      font-weight: 600;
      overflow: hidden;
      border: 3px solid #20806852;
      cursor: pointer;
      transition: box-shadow 0.2s;
      box-shadow: 0 2px 10px #aeaeae34;
    }
    .profile-pic:hover {
      box-shadow: 0 0 0 3px #208068;
    }
    .profile-upload {
      display: none;
    }
    .user-info {
      font-size: 22px;
      color: #145042;
      margin-bottom: 6px;
    }
    .field-label {
      font-weight: bold;
      margin-right: 7px;
      color: #208068;
      font-size: 18px;
    }
    .ratings {
      margin-top: 22px;
      font-size: 22px;
      color: #208068;
    }
    .star {
      color: #f0c543;
      font-size: 26px;
      margin-right: 4px;
    }
    .star-empty {
      color: #cccccc;
    }
  </style>
  <script>
    function triggerProfilePicInput() {
      document.getElementById('profilePicInput').click();
    }
    function handleProfilePicChange(input) {
      const form = document.getElementById('profilePicForm');
      form.submit();
    }
  </script>
</head>
<body>
  <div class="header">
    ECO SAVER
  </div>
  <div class="sidebar">
    <a href="/home">Home</a>
    <a href="/settings">Settings</a>
    <a href="/listings">Listing</a>
    <a href="/cart">Cart</a>
    <a href="/dashboard">Dashboard</a>
    <a href="/auth/logout">Logout</a>
  </div>
  <div class="main">
    <div class="dashboard-title">DASHBOARD</div>
    <div class="profile-row">
      <!-- Profile Picture (clickable circle) -->
      <form id="profilePicForm" method="POST" action="/dashboard/profile-pic" enctype="multipart/form-data" style="display:inline;">
        <div class="profile-pic-area" onclick="triggerProfilePicInput()">
          <div class="profile-pic">
            <% if (user.profilePic) { %>
              <img src="<%= user.profilePic %>" alt="Profile Pic" style="width:100%;height:100%;object-fit:cover;" />
            <% } else { %>
              <span>Profile</span>
            <% } %>
          </div>
          <input id="profilePicInput" class="profile-upload" type="file" name="profilePic"
            accept="image/*" onchange="handleProfilePicChange(this)" />
        </div>
      </form>
      <!-- User info -->
      <div>
        <div class="user-info">
          <span class="field-label">User name:</span>
          <span><%= user.username %></span>
        </div>
        <div class="user-info">
          <span class="field-label">Email:</span>
          <span><%= user.email %></span>
        </div>
      </div>
    </div>
    <div class="ratings">
      <span class="field-label">Ratings:</span>
      <% for (let i = 0; i < 5; i++) { %>
        <span class="star <%= user.rating > i ? '' : 'star-empty' %>">
          <%= user.rating > i ? '★' : '☆' %>
        </span>
      <% } %>
    </div>
  </div>
</body>
</html>
